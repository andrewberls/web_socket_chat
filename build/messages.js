// Generated by CoffeeScript 1.3.3
var MessageListView, MessageView,
  __hasProp = {}.hasOwnProperty;

MessageView = Backbone.View.extend({
  template: _.template($('#template-socket-message').html()),
  render: function() {
    $(this.el).html(this.template(this.model));
    return this;
  }
});

MessageListView = Backbone.View.extend({
  template: _.template($('#template-socket-message-list').html()),
  initialize: function() {
    this.model.on('socket:message', this.onMessage, this);
    this.data = [];
    return this.loadMessages();
  },
  loadMessages: function() {
    var _this = this;
    $(this.el).html('');
    return $.ajax({
      url: "/messages.json",
      success: function(json) {
        var id, msg, text, _i, _len, _ref, _results;
        _ref = JSON.parse(json);
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          msg = _ref[_i];
          _results.push((function() {
            var _results1;
            _results1 = [];
            for (id in msg) {
              if (!__hasProp.call(msg, id)) continue;
              text = msg[id];
              _results1.push($(this.el).append("              <div class='message'>                <p>" + text + "</p>              </div>            "));
            }
            return _results1;
          }).call(_this));
        }
        return _results;
      }
    });
  },
  onMessage: function(msg) {
    this.data.push({
      message: msg
    });
    return this.render();
  },
  render: function() {
    this.loadMessages();
    return this;
  }
});
